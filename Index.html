<!DOCTYPE html>
<html style="width:100%; height:100%;">
    <head>
        <link rel="stylesheet" type="text/css" href="css/reset.css">       
        <script src="scripts/requirejs.js"></script>
        <!--<script src="scripts/isotile.js"></script>
        <script src="scripts/isocanvas.js"></script>-->
        <script type="text/javascript">
            function f() {

                requirejs(['scripts/isotile', 'scripts/isocanvas'], function(isoTileNameSpace, isoCanvasNameSpace) {

                    var isoCanvas = new isoCanvasNameSpace.IsoCanvas(document.getElementById('isoCanvasDiv'));

                    // load up tiles
                    var imgs = [];
                    var loadedCounter = 0;
                    var numImages = 4;
                    for (var i = 0; i < numImages; i++) {

                        imgs.push(new Image());

                        imgs[i].onload = function() {

                            loadedCounter++;
                            if (loadedCounter == numImages) {
                                isoCanvas.tiles = imgs;
                                isoCanvas.layers.push(generateMap(numImages));
                                isoCanvas.paint();
                                window.addEventListener('resize', function(ev) {
                                    //isoCanvas.defaultResizeListener(ev);
                                    isoCanvas.paint();
                                });
                                window.addEventListener('click', function(ev) {                                
                                    isoCanvas.defaultMouseClickListener(ev);
                                    isoCanvas.paint();
                                });
                                window.addEventListener('wheel', function(ev) {
                                    isoCanvas.defaultMouseWheelListener(ev);
                                    isoCanvas.paint();
                                });
                            }
                        };
                    }
                    imgs[0].src = 'Tiles/grass1.png';
                    imgs[1].src = 'Tiles/grass2.png';
                    imgs[2].src = 'Tiles/grass3.png';
                    imgs[3].src = 'Tiles/water1.png';                    
                });

            }

            function generateMap(numTiles) {
                // generate random map
                var layer = []
                for (var y = 0; y < 100; y++) {
                    layer.push([]);
                    for (var x = 0; x < 100; x++) {
                        layer[y].push(Math.floor(Math.random()*numTiles));
                    }
                }
                return layer;
            }
        

        </script>
    </head>
    <body style="width:100%; height:100%;" onload="f()">
        <div id="isoCanvasDiv" style="width:100%; height:100%;"></div>
    </body>
</html>